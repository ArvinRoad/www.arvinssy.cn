{"title":"Three.Js开发WebGL鼠标操作三维场景","uid":"78bba4eb245f0658532280227722a7b2","slug":"ThreeJsWebGL_2022_4.19.04","date":"2022-04-20T07:43:00.000Z","updated":"2023-11-26T10:38:32.669Z","comments":true,"path":"api/articles/ThreeJsWebGL_2022_4.19.04.json","keywords":null,"cover":"https://pic3.zhimg.com/v2-7af105b5915de8a7fdcf6332b681aba5_r.jpg","content":"<h1 id=\"Three-Js开发WebGL鼠标操作三维场景\"><a href=\"#Three-Js开发WebGL鼠标操作三维场景\" class=\"headerlink\" title=\"Three.Js开发WebGL鼠标操作三维场景\"></a>Three.Js开发WebGL鼠标操作三维场景</h1><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>Three.Js GitHub地址：<a href=\"https://github.com/mrdoob/three.js\">点击跳转</a></p></blockquote>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>Three.Js API说明文档：<a href=\"https://threejs.org/docs/index.html#manual/zh/introduction/Creating-a-scene\">点击跳转</a></p></blockquote>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>或复制网页端Three.js源码使用：<a href=\"https://threejs.org/build/three.js\">点击跳转</a></p></blockquote>\n<h2 id=\"WEBGL-三维控制器-放置在Script标签下-：\"><a href=\"#WEBGL-三维控制器-放置在Script标签下-：\" class=\"headerlink\" title=\"WEBGL 三维控制器(放置在Script标签下)：\"></a>WEBGL 三维控制器(放置在Script标签下)：</h2><pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\"> &#x2F;&#x2F; 三维场景控制器渲染\nvar controls &#x3D; new THREE.OrbitControls(camera,renderer.domElement);   &#x2F;&#x2F; 参数：(绑定的摄像机,要事件监听的HTML元素)\n&#x2F;&#x2F; 监听控制器鼠标事件\ncontrols.addEventListener(&#39;change&#39;,()&#x3D;&gt;&#123;\n    renderer.render(scene,camera);\n&#125;);</code></pre>\n<p>OrbitControls 必须将要被控制的相机。该相机不允许是其他任何对象的子级，除非该对象是场景自身。</p>\n<p>注意：这里为优化阴影反射效果对聚光灯属性进行了设置调整</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">spotLight.angle &#x3D; Math.PI &#x2F; 10;  &#x2F;&#x2F; 聚光灯扩散范围\nspotLight.shadow.penumbra &#x3D; 0.05    &#x2F;&#x2F; 阴影衰减情况\nspotLight.shadow.mapSize.window &#x3D; 1024; &#x2F;&#x2F; 设置阴影精度\nspotLight.shadow.mapSize.innerHeight &#x3D; 1024;</code></pre>\n\n<h2 id=\"完整实例代码：\"><a href=\"#完整实例代码：\" class=\"headerlink\" title=\"完整实例代码：\"></a>完整实例代码：</h2><pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\">&lt;!doctype html&gt;\n&lt;html lang&#x3D;&quot;zh-CN&quot;&gt;\n&lt;head&gt;\n    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;\n    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, user-scalable&#x3D;no, initial-scale&#x3D;1.0, maximum-scale&#x3D;1.0, minimum-scale&#x3D;1.0&quot;&gt;\n    &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;Edge&quot;&gt;\n    &lt;title&gt;Demo-01&lt;&#x2F;title&gt;\n    &lt;script src&#x3D;&quot;libs&#x2F;build&#x2F;three.js&quot;&gt;&lt;&#x2F;script&gt;\n    &lt;script src&#x3D;&quot;libs&#x2F;js&#x2F;controls&#x2F;OrbitControls.js&quot;&gt;&lt;&#x2F;script&gt;\n    &lt;style&gt;\n        body&#123;\n            margin: 0;\n            overflow: hidden;\n        &#125;\n    &lt;&#x2F;style&gt;\n&lt;&#x2F;head&gt;\n\n&lt;body&gt;\n\n&lt;div id&#x3D;&quot;webGl-output&quot;&gt;\n\n&lt;&#x2F;div&gt;\n\n&lt;!-- Script --&gt;\n&lt;script&gt;\n    function init()&#123;\n        &#x2F;&#x2F; 创建场景\n        var scene &#x3D; new THREE.Scene();\n        &#x2F;&#x2F; 设置摄像机 (45度,长宽比&lt;当前屏幕宽&#x2F;屏幕高&gt;,最近可视距离,最远可视距离)\n        var camera &#x3D; new THREE.PerspectiveCamera(45,window.innerWidth&#x2F;window.innerHeight,0.1,2000);\n        &#x2F;&#x2F; 创建渲染器\n        var renderer &#x3D; new THREE.WebGLRenderer();\n        &#x2F;&#x2F; 渲染器初始化颜色\n        renderer.setClearColor(new THREE.Color(0xEEEEEE));\n        &#x2F;&#x2F; 渲染输出 Canvas 画面大小\n        renderer.setSize(window.innerWidth,window.innerHeight);\n        &#x2F;&#x2F; 设置渲染物体阴影\n        renderer.shadowMapEnabled &#x3D; true;\n        &#x2F;&#x2F; 创建显示卡迪坐标轴\n        var axes &#x3D; new THREE.AxesHelper(20);\n        &#x2F;&#x2F; 添加坐标系到场景\n        scene.add(axes);\n        &#x2F;&#x2F; 场景创建平面(地面几何体)\n        var planeGeometry &#x3D; new THREE.PlaneGeometry(60,20);\n        &#x2F;&#x2F; 设置平面(地面)材质\n        var PlaneMaterial &#x3D; new THREE.MeshStandardMaterial(&#123;color:0xCCCCCC&#125;);\n        &#x2F;&#x2F; 创建地面 通过 THREE.Mesh 进行结合操作\n        var plane &#x3D; new THREE.Mesh(planeGeometry,PlaneMaterial);\n        &#x2F;&#x2F; 物体位移坐标\n        plane.rotation.x &#x3D; -0.5*Math.PI;\n        plane.position.x &#x3D; 0;\n        plane.position.y &#x3D; 0;\n        plane.position.z &#x3D; 0;\n        &#x2F;&#x2F; 设置地面接收阴影\n        plane.castShadow &#x3D; true;\n        plane.receiveShadow &#x3D; true;\n        &#x2F;&#x2F; 将地面添加到场景\n        scene.add(plane);\n\n        &#x2F;&#x2F; 添加立方体\n        var cubeGeometry &#x3D; new THREE.BoxGeometry(4,4,4);\n        var cubeMaterial &#x3D; new THREE.MeshLambertMaterial(&#123;color: 0xFFB6C1&#125;); &#x2F;&#x2F; 添加网格材质\n        var cube &#x3D; new THREE.Mesh(cubeGeometry,cubeMaterial);\n        cube.position.x &#x3D; 0;\n        cube.position.y &#x3D; 5;\n        cube.position.z &#x3D; 2;\n        &#x2F;&#x2F; 球体\n        var sphereGeometry &#x3D; new THREE.SphereGeometry(4,20,20);\n        var sphereMaterial &#x3D; new THREE.MeshLambertMaterial(&#123;color: 0xFFB6C1&#125;);\n        var Sphere &#x3D; new THREE.Mesh(sphereGeometry,sphereMaterial);\n        Sphere.position.x &#x3D; 10;\n        Sphere.position.y &#x3D; 4;\n        Sphere.position.z &#x3D; 2;\n        &#x2F;&#x2F; 对象是否渲染到阴影贴图\n        cube.castShadow &#x3D; true;\n        Sphere.castShadow &#x3D; true;\n        scene.add(cube)\n        scene.add(Sphere);\n\n        &#x2F;&#x2F; 创建添加聚光灯\n        var spotLight &#x3D; new THREE.SpotLight(0xFFFFFF);\n        spotLight.position.set(130,130,-130);\n        spotLight.castShadow &#x3D; true;\n        spotLight.angle &#x3D; Math.PI &#x2F; 10;  &#x2F;&#x2F; 聚光灯扩散范围\n        spotLight.shadow.penumbra &#x3D; 0.05    &#x2F;&#x2F; 阴影衰减情况\n        spotLight.shadow.mapSize.window &#x3D; 1024; &#x2F;&#x2F; 设置阴影精度\n        spotLight.shadow.mapSize.innerHeight &#x3D; 1024;\n\n        scene.add(spotLight);\n\n        &#x2F;&#x2F; 定位摄影机视角指向场景中心点\n        camera.position.x &#x3D; 30;\n        camera.position.y &#x3D; 30;\n        camera.position.z &#x3D; 30;\n        camera.lookAt(scene.position)\n        &#x2F;&#x2F; 渲染器输出添加至 HTML\n        document.getElementById(&#39;webGl-output&#39;).appendChild(renderer.domElement);\n        &#x2F;&#x2F; 最终渲染\n        renderer.render(scene,camera);\n\n        &#x2F;&#x2F; 三维场景控制器渲染\n        var controls &#x3D; new THREE.OrbitControls(camera,renderer.domElement);   &#x2F;&#x2F; 参数：(绑定的摄像机,要事件监听的HTML元素)\n        &#x2F;&#x2F; 监听控制器鼠标事件\n        controls.addEventListener(&#39;change&#39;,()&#x3D;&gt;&#123;\n            renderer.render(scene,camera);\n        &#125;);\n\n        &#x2F;&#x2F; 计算渲染时间\n        let T0 &#x3D; new Date();\n\n        &#x2F;&#x2F; 渲染函数\n        function render()&#123;\n            let T1 &#x3D; new Date();\n            let T &#x3D; T1 - T0;    &#x2F;&#x2F;  T 为时间差\n            T0 &#x3D; T1;\n            renderer.render(scene,camera);\n            cube.rotateY(0.001 * T); &#x2F;&#x2F; 每1毫旋转0.001 * 时间差\n            window.requestAnimationFrame(render);   &#x2F;&#x2F; 递归\n        &#125;\n        &#x2F;&#x2F; 请求动画帧\n        window.requestAnimationFrame(render);\n    &#125;\n    window.onload &#x3D; init    &#x2F;&#x2F; 全部加载完成后运行\n&lt;&#x2F;script&gt;\n&lt;&#x2F;body&gt;\n&lt;&#x2F;html&gt;</code></pre>","feature":true,"text":"Three.Js开发WebGL鼠标操作三维场景 Three.Js GitHub地址：点击跳转 Three.Js API说明文档：点击跳转 或复制网页端Three...","link":"","photos":[],"count_time":{"symbolsCount":"5.8k","symbolsTime":"5 mins."},"categories":[{"name":"程序","slug":"程序","count":29,"path":"api/categories/程序.json"}],"tags":[{"name":"教学文档","slug":"教学文档","count":33,"path":"api/tags/教学文档.json"},{"name":"博客网站","slug":"博客网站","count":6,"path":"api/tags/博客网站.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Three-Js%E5%BC%80%E5%8F%91WebGL%E9%BC%A0%E6%A0%87%E6%93%8D%E4%BD%9C%E4%B8%89%E7%BB%B4%E5%9C%BA%E6%99%AF\"><span class=\"toc-text\">Three.Js开发WebGL鼠标操作三维场景</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#WEBGL-%E4%B8%89%E7%BB%B4%E6%8E%A7%E5%88%B6%E5%99%A8-%E6%94%BE%E7%BD%AE%E5%9C%A8Script%E6%A0%87%E7%AD%BE%E4%B8%8B-%EF%BC%9A\"><span class=\"toc-text\">WEBGL 三维控制器(放置在Script标签下)：</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%AE%8C%E6%95%B4%E5%AE%9E%E4%BE%8B%E4%BB%A3%E7%A0%81%EF%BC%9A\"><span class=\"toc-text\">完整实例代码：</span></a></li></ol></li></ol>","author":{"name":"Arvin","slug":"blog-author","avatar":"/imgs/head.jpg","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"Three.Js开发WebGL地月环绕","uid":"c000f7024ccb6c476e7ef6fa4b60fe28","slug":"ThreeJsWebGL_2022_4.20.01","date":"2022-04-21T07:19:00.000Z","updated":"2023-11-26T10:38:32.669Z","comments":true,"path":"api/articles/ThreeJsWebGL_2022_4.20.01.json","keywords":null,"cover":"https://pic3.zhimg.com/v2-7af105b5915de8a7fdcf6332b681aba5_r.jpg","text":"Three.Js开发WebGL地月环绕 Three.Js GitHub地址：点击跳转 Three.Js API说明文档：点击跳转 或复制网页端Three.js源...","link":"","photos":[],"count_time":{"symbolsCount":"6.8k","symbolsTime":"6 mins."},"categories":[{"name":"程序","slug":"程序","count":29,"path":"api/categories/程序.json"}],"tags":[{"name":"教学文档","slug":"教学文档","count":33,"path":"api/tags/教学文档.json"},{"name":"博客网站","slug":"博客网站","count":6,"path":"api/tags/博客网站.json"}],"author":{"name":"Arvin","slug":"blog-author","avatar":"/imgs/head.jpg","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"Three.Js开发WebGL动画实现与请求动画帧","uid":"25cfc3fbb38e9037315da011452084c9","slug":"ThreeJsWebGL_2022_4.19.03","date":"2022-04-19T10:01:00.000Z","updated":"2023-11-26T10:38:32.669Z","comments":true,"path":"api/articles/ThreeJsWebGL_2022_4.19.03.json","keywords":null,"cover":"https://pic3.zhimg.com/v2-7af105b5915de8a7fdcf6332b681aba5_r.jpg","text":"Three.Js开发WebGL动画实现与请求动画帧 Three.Js GitHub地址：点击跳转 Three.Js API说明文档：点击跳转 或复制网页端Thr...","link":"","photos":[],"count_time":{"symbolsCount":"5.5k","symbolsTime":"5 mins."},"categories":[{"name":"程序","slug":"程序","count":29,"path":"api/categories/程序.json"}],"tags":[{"name":"教学文档","slug":"教学文档","count":33,"path":"api/tags/教学文档.json"},{"name":"博客网站","slug":"博客网站","count":6,"path":"api/tags/博客网站.json"}],"author":{"name":"Arvin","slug":"blog-author","avatar":"/imgs/head.jpg","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}